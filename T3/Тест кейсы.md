# Тест-кейсы для REST API GET /products/{productId}/cost?authToken=&count=&start=

## TC-01: Проверка успешного расчёта стоимости (count ≤ 5)

**Severity:** Critical

**Предусловия:**
- Существующий productId
- Валидный `authToken`
- Таблица цен:

| № экземпляра | 1   | 2   | 3   | 4   | 5   |
| ------------ | --- | --- | --- | --- | --- |
| Стоимость    | 30  | 25  | 20  | 15  | 10  |

**Шаги:**
1. Отправить GET /products/{productId}/cost с валидным authToken, count и start в пределах 1–5
2. Проверить статус код и тело ответа

**Ожидаемый результат:**
- HTTP 200 OK
- Тело: `{"cost": <ожидаемое значение>}`

|№|start|count|Рассчитанная последовательность позиций|Формула расчёта|Ожидаемый cost|
|---|---|---|---|---|---|
|1|0|1|[1]|30|30|
|2|0|5|[1, 2, 3, 4, 5]|30+25+20+15+10|100|
|3|2|2|[3, 4]|20+15|35|
|4|4|1|[5]|10|10|
|5|1|3|[2, 3, 4]|25+20+15|60|
|6|3|2|[4, 5]|15+10|25|

## TC-02: Проверка расчёта стоимости партиями (count > 5)

**Severity:** Critical

**Предусловия:**
- Существующий productId
- Валидный `authToken`
- Таблица цен:

| № экземпляра | 1   | 2   | 3   | 4   | 5   |
| ------------ | --- | --- | --- | --- | --- |
| Стоимость    | 30  | 25  | 20  | 15  | 10  |

**Шаги:**
1. Отправить GET /products/{productId}/cost с валидным authToken и count > 5
2. Проверить статус код и тело ответа

**Особенность расчёта:**  
Если count > 5, стоимость считается партиями по 5.  
На каждую новую партию таблица цен начинается сначала (позиции сбрасываются).

**Ожидаемый результат:**
- HTTP 200 OK
- Тело: `{"cost": <ожидаемое значение>}`

| №   | start | count | Расчёт партий                     | Формула расчёта                 | Ожидаемый cost |
| --- | ----- | ----- | --------------------------------- | ------------------------------- | -------------- |
| 1   | 0     | 6     | 1-я партия: [1,2,3,4,5], 2-я: [1] | 30+25+20+15+10 + 30             | 130            |
| 2   | 0     | 10    | 1-я: [1–5], 2-я: [1–5]            | 30+25+20+15+10 + 30+25+20+15+10 | 200            |
| 3   | 1     | 6     | 1-я: [2–5], 2-я: [1–2]            | 25+20+15+10 + 30+25             | 125            |
| 4   | 3     | 8     | 1-я: [4,5], 2-я: [1–5], 3-я: [1]  | 15+10 + 30+25+20+15+10 + 30     | 175            |
| 5   | 0     | 7     | 1-я: [1–5], 2-я: [1–2]            | 100 + 30+25                     | 155            |
| 6   | 4     | 5     | 1-я: [5], 2-я: [1–4]              | 10 + 30+25+20+15                | 100            |

## TC-03: Проверка авторизации: ошибки при некорректном или отсутствующем authToken

**Severity:** Critical

**Предусловия:**
- Существующий productId

**Шаги:**
1. Отправить GET /products/{productId}/cost с некорректным или отсутствующим authToken
2. Проверить статус код

**Ожидаемый результат:**
- HTTP 401 Unauthorized

| №   | authToken             | Описание                                  |
| --- | --------------------- | ----------------------------------------- |
| 1   |                       | Нет параметра authToken                   |
| 2   | abc123                | Токен меньше 16 символов                  |
| 3   | 12345678901234567     | Токен больше 16 символов                  |
| 4   | 123456789012345X      | Токен валидной длины, но невалидный       |
| 5   | `!@#$%^&*()_+=-,~     | Специальные символы                       |
| 6   | истекший-токен-пример | Валидный токен с истекшим сроком действия |
| 7   | АБВГДЕЖЗИЙКЛМНОП      | Токен с кириллицей                        |

## TC-04: Проверка ошибки при несуществующем productId

**Severity:** Critical

**Предусловия:**
- productId отсутствует в системе
- Валидный authToken

**Шаги:**
1. Отправить GET /products/{несуществующийId}/cost
2. Проверить статус-код

**Ожидаемый результат:**
- HTTP 404 Not Found

## TC-05: Проверка обработки внутренних ошибок сервера

**Severity:** Blocker

**Предусловия:**
- Валидный authToken
- Существующий productId
- Искусственно эмулирован сбой

**Шаги:**
1. Отправить GET /products/{productId}/cost с валидным authToken, count и start
2. Проверить статус код и тело ответа

**Ожидаемый результат:**
- HTTP 500 Internal Server Error
- Тело: `{"errorMessage": "..."}`

## TC-06: Проверка обработки некорректных значений параметров count и start

**Severity:** Critical

**Предусловия:**
- Существующий productId
- Валидный authToken

**Шаги:**
1. Отправить GET /products/{productId}/cost с валидным authToken и с недопустимыми значениями count и start
2. Проверить статус код и тело ответа

**Ожидаемый результат:**
- HTTP 500 Internal Server Error
- Тело: `{"errorMessage": "..."}`

| №   | Параметр | Значение | Описание                 |
| --- | -------- | -------- | ------------------------ |
| 1   | count    | -1       | Отрицательное число      |
| 2   | count    | abc      | Строка                   |
| 3   | count    | !@#      | Спецсимволы              |
| 4   | count    | 9999999  | Слишком большое значение |
| 5   | start    | -1       | Отрицательное число      |
| 6   | start    | строка   | Неверный тип             |
| 7   | start    | !@#      | Спецсимволы              |
| 8   | start    | 9999999  | Слишком большое значение |
